"use strict";(self.webpackChunktemporary_access=self.webpackChunktemporary_access||[]).push([[865],{"./assets/js/datastores/constants.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{E:()=>STORE_NAME,r:()=>UI_STORE_NAME});const STORE_NAME="passwordless-temporary-login",UI_STORE_NAME="passwordless-login/ui"},"./assets/js/datastores/validations.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{$F:()=>validateUserID,B9:()=>isValidEmail,Tu:()=>validateUserCreationParams,t_:()=>isValidRole,uV:()=>isValidName,vd:()=>isValidDate});var invariant__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/invariant/browser.js"),invariant__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(invariant__WEBPACK_IMPORTED_MODULE_0__),lodash__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/lodash/lodash.js"),_wordpress_i18n__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@wordpress/i18n/build-module/index.js");const validateUserCreationParams=function(userData){return invariant__WEBPACK_IMPORTED_MODULE_0___default()((0,lodash__WEBPACK_IMPORTED_MODULE_1__.isPlainObject)(userData),(0,_wordpress_i18n__WEBPACK_IMPORTED_MODULE_2__.__)("Params must be an object","passwordless-temporary-login")),invariant__WEBPACK_IMPORTED_MODULE_0___default()(userData.user_email,"Email is required."),!0},validateUserID=function({userId}){invariant__WEBPACK_IMPORTED_MODULE_0___default()(userId,"User ID is required."),invariant__WEBPACK_IMPORTED_MODULE_0___default()("number"==typeof userId,"User ID must be a number.")},isValidName=name=>"string"==typeof name&&/^(?=.{1,50}$)[a-z]+(?:['_.\s][a-z]+)*$/i.test(name),isValidEmail=email=>/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,}$/i.test(email),isValidRole=role=>{const availableRoles=Object.keys(tempAccess.roles);return"string"==typeof role&&availableRoles.includes(role)},isValidDate=date=>{const timestamp=new Date(date).getTime();return!isNaN(timestamp)}},"./tests/js/WithRegistrySetup.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var react_use__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react-use/esm/useMount.js"),invariant__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/invariant/browser.js"),invariant__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(invariant__WEBPACK_IMPORTED_MODULE_0__),_wordpress_element__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react/index.js"),_wordpress_data__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@wordpress/data/build-module/components/registry-provider/use-registry.js");const __WEBPACK_DEFAULT_EXPORT__=function WithRegistrySetup({func,children}){const registry=(0,_wordpress_data__WEBPACK_IMPORTED_MODULE_1__.A)(),[ready,setReady]=(0,_wordpress_element__WEBPACK_IMPORTED_MODULE_2__.useState)(!1);return invariant__WEBPACK_IMPORTED_MODULE_0___default()("function"==typeof func,"func must be a function."),(0,react_use__WEBPACK_IMPORTED_MODULE_3__.A)((async()=>{await func(registry),setReady(!0)})),ready?children:null}},"./tests/js/utils/test-utils.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{MG:()=>WithTestRegistry,Cj:()=>createTestRegistry});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),browser=__webpack_require__("./node_modules/invariant/browser.js"),browser_default=__webpack_require__.n(browser),build_module_registry=(__webpack_require__("./node_modules/@testing-library/react/dist/@testing-library/react.esm.js"),__webpack_require__("./node_modules/@testing-library/user-event/dist/esm/index.js"),__webpack_require__("./node_modules/@wordpress/data/build-module/registry.js")),context=__webpack_require__("./node_modules/@wordpress/data/build-module/components/registry-provider/context.js"),redux_store=__webpack_require__("./node_modules/@wordpress/data/build-module/redux-store/index.js"),build_module=__webpack_require__("./node_modules/@wordpress/api-fetch/build-module/index.js"),add_query_args=__webpack_require__("./node_modules/@wordpress/url/build-module/add-query-args.js");const tempAccessRequest=async({data,method="GET",path="",queryParams,signal})=>{try{return await(0,build_module.A)({data,method,signal,url:(0,add_query_args.F)(`${tempAccess?.path}/${path}`,queryParams)})}catch(error){if(error instanceof Error&&"AbortError"===error.name)return null;throw error}},api={get:(data={})=>tempAccessRequest(data),set:async(data,options={})=>{const{method="POST",queryParams,path,signal}=options;return await tempAccessRequest({data,method,path,queryParams,signal})},remove:async(data,options={})=>{const{method="DELETE",path="",queryParams,signal}=options;return await tempAccessRequest({data,method,queryParams,path,signal})}};void 0===__webpack_require__.g.tempuser&&(__webpack_require__.g.tempuser={}),void 0===__webpack_require__.g.tempuser.api&&(__webpack_require__.g.tempuser.api=api);const tempuser_api=api;var lodash=__webpack_require__("./node_modules/lodash/lodash.js"),md5_md5=__webpack_require__("./node_modules/md5/md5.js"),md5_default=__webpack_require__.n(md5_md5);const stringify_stringifyObject=obj=>md5_default()(JSON.stringify(sortObjectProperties(obj)));function sortObjectProperties(obj){const orderedData={};return Object.keys(obj).sort().forEach((key=>{let val=obj[key];val&&"object"==typeof val&&!Array.isArray(val)&&(val=sortObjectProperties(val)),orderedData[key]=val})),orderedData}const actions={receiveError:(error,baseName,args=[])=>(browser_default()(error,"error is required."),browser_default()(baseName,"baseName is required."),browser_default()(args&&Array.isArray(args),"args must be an array."),{type:"RECEIVE_ERROR",payload:{error,baseName,args}}),clearError:(baseName,args=[])=>(browser_default()(baseName,"baseName is required."),browser_default()(args&&Array.isArray(args),"args must be an array."),{type:"CLEAR_ERROR",payload:{baseName,args}}),clearErrors:baseName=>({type:"CLEAR_ERRORS",payload:{baseName}})};const defaultReducerCallback=state=>state,defaultArgsToParams=()=>({}),defaultValidateParams=()=>{},{clearError,receiveError}=actions,createFetchStore=({baseName,controlCallback,reducerCallback=defaultReducerCallback,argsToParams=defaultArgsToParams,validateParams=defaultValidateParams})=>{let requiresParams;browser_default()(baseName,"baseName is required."),browser_default()("function"==typeof controlCallback,"controlCallback is required and must be a function."),browser_default()("function"==typeof reducerCallback,"reducerCallback must be a function."),browser_default()("function"==typeof argsToParams,"argsToParams must be a function."),browser_default()("function"==typeof validateParams,"validateParams must be a function.");try{validateParams(argsToParams()),requiresParams=!1}catch(error){requiresParams=!0}const pascalCaseBaseName=(name=baseName).charAt(0).toUpperCase()+name.slice(1);var name;const constantBaseName=(name=>name.replace(/([a-z0-9]{1})([A-Z]{1})/g,"$1_$2").toUpperCase())(baseName),FETCH=`FETCH_${constantBaseName}`,START_FETCH=`START_${FETCH}`,FINISH_FETCH=`FINISH_${FETCH}`,CATCH_FETCH=`CATCH_${FETCH}`,RECEIVE=`RECEIVE_${constantBaseName}`,fetchCreator=`fetch${pascalCaseBaseName}`,receiveCreator=`receive${pascalCaseBaseName}`,isFetching=`isFetching${pascalCaseBaseName}`,initialState={[isFetching]:{}};const actions={[fetchCreator](...args){const params=argsToParams(...args);return validateParams(params),function*fetchGenerator(params,args){let response,error;yield{payload:{params},type:START_FETCH},yield clearError(baseName,args);try{response=yield{payload:{params},type:FETCH},yield actions[receiveCreator](response,params),yield{payload:{params},type:FINISH_FETCH}}catch(e){error=e,yield receiveError(error,baseName,args),yield{payload:{params},type:CATCH_FETCH}}return{response,error}}(params,args)},[receiveCreator]:(response,params)=>(browser_default()(void 0!==response,"response is required."),requiresParams?(browser_default()((0,lodash.isPlainObject)(params),"params is required."),validateParams(params)):params={},{payload:{response,params},type:RECEIVE})};return{initialState,actions,controls:{[FETCH]:({payload})=>controlCallback(payload.params)},reducer:(state,{type,payload})=>{switch(type){case START_FETCH:{const{params}=payload;return{...state,[isFetching]:{...state[isFetching],[stringify_stringifyObject(params)]:!0}}}case RECEIVE:{const{response,params}=payload;return reducerCallback(state,response,params)}case FINISH_FETCH:{const{params}=payload;return{...state,[isFetching]:{...state[isFetching],[stringify_stringifyObject(params)]:!1}}}case CATCH_FETCH:{const{params}=payload;return{...state,[isFetching]:{...state[isFetching],[stringify_stringifyObject(params)]:!1}}}default:return state}},resolvers:{},selectors:{[isFetching]:(state,...args)=>{if(void 0===state[isFetching])return!1;let params;try{params=argsToParams(...args),validateParams(params)}catch(err){return!1}return!!state[isFetching][stringify_stringifyObject(params)]}}}},collect=(...items)=>{const collectedObject=items.reduce(((acc,item)=>({...acc,...item})),{}),functionNames=items.reduce(((acc,itemSet)=>[...acc,...Object.keys(itemSet)]),[]),duplicates=findDuplicates(functionNames);return browser_default()(0===duplicates.length,`collect() cannot accept collections with duplicate keys. Your call to collect() contains the following duplicated functions: ${duplicates.join(", ")}. Check your data stores for duplicates.`),collectedObject},collectActions=collect,collectControls=collect,collectReducers=(...args)=>{const reducers=[...args];let initialState;return"function"!=typeof reducers[0]&&(initialState=reducers.shift()),(state=initialState,action={})=>reducers.reduce(((newState,reducer)=>reducer(newState,action)),state)},collectResolvers=collect,collectSelectors=collect,collectState=collect,passthroughReducer=state=>state,combineStores=(...stores)=>{const combinedInitialState=collectState(...stores.map((store=>store.initialState||{})));return{initialState:combinedInitialState,controls:collectControls(...stores.map((store=>store.controls||{}))),actions:collectActions(...stores.map((store=>store.actions||{}))),reducer:collectReducers(combinedInitialState,...stores.map((store=>store.reducer||passthroughReducer))),resolvers:collectResolvers(...stores.map((store=>store.resolvers||{}))),selectors:collectSelectors(...stores.map((store=>store.selectors||{})))}},findDuplicates=array=>{const duplicates=[],counts={};for(let i=0;i<array.length;i++){const item=array[i];counts[item]=counts[item]>=1?counts[item]+1:1,counts[item]>1&&duplicates.push(item)}return duplicates};var validations=__webpack_require__("./assets/js/datastores/validations.js");const fetchGetUsers=createFetchStore({baseName:"getUsers",controlCallback:params=>{const{page,pageSize}=params;return tempuser_api.get({queryParams:{page:page+1,per_page:pageSize}})},reducerCallback:(state,{users,total},params)=>{const hash=stringify_stringifyObject(params);return{...state,users:{...state.users,[hash]:users},total}},validateParams:params=>{browser_default()((0,lodash.isPlainObject)(params),"params is required."),browser_default()(void 0!==params.page,"page is required."),browser_default()("number"==typeof params.page,"page should be number.")},argsToParams:params=>params}),fetchCreateUser=createFetchStore({baseName:"createUser",controlCallback:userData=>{const path=userData.ID?userData.ID.toString():"";return tempuser_api.set(userData,{path})},reducerCallback:state=>state,validateParams:validations.Tu,argsToParams:data=>({ID:data?.ID,user_email:data?.user_email,first_name:data?.first_name,last_name:data?.last_name,role:data?.role,start_date:data?.start_date,end_date:data?.end_date})}),fetchDeleteUser=createFetchStore({baseName:"deleteUser",controlCallback:userData=>{const options={method:"DELETE",path:userData.userId};return tempuser_api.remove({},options)},reducerCallback:state=>state,validateParams:validations.$F,argsToParams:params=>({userId:params?.userId})}),baseActions={*createUser(userData){const{response,error}=yield fetchCreateUser.actions.fetchCreateUser(userData);return{response,error}},*deleteUser(userId){const{response,error}=yield fetchDeleteUser.actions.fetchDeleteUser({userId});return{response,error}}},baseResolvers={*getUsers(args){yield fetchGetUsers.actions.fetchGetUsers(args)}},store=combineStores(fetchGetUsers,fetchCreateUser,fetchDeleteUser,{initialState:{users:[],total:0},actions:baseActions,controls:{},reducer:passthroughReducer,resolvers:baseResolvers,selectors:{getState:state=>state,getUsers(state,args={}){const hash=stringify_stringifyObject(args);return state.users[hash]},getTotalUsers:state=>state.total}}),users=(store.initialState,store.actions,store.controls,store.reducer,store.resolvers,store.selectors,store);var i18n_build_module=__webpack_require__("./node_modules/@wordpress/i18n/build-module/index.js");const allowedNoticeTypes=["error","warning","success","info"],notices_store=combineStores({initialState:{notices:[]},actions:{clearNotices:()=>({type:"CLEAR_NOTICES",payload:{}}),setNotice:({code,noticeType,message})=>(browser_default()(allowedNoticeTypes.includes(noticeType),(0,i18n_build_module.__)("Invalid notice type.","passwordless-temporary-login")),{type:"SET_NOTICE",payload:{code,message,noticeType}}),deleteNotice:({code})=>({type:"DELETE_NOTICE",payload:{code}})},controls:{},reducer:(state,{type,payload})=>{switch(type){case"CLEAR_NOTICES":return{...state,notices:[]};case"DELETE_NOTICE":{const{code}=payload,newNotices=state.notices.filter((notice=>notice.code!==code));return{...state,notices:newNotices}}case"SET_NOTICE":{const{code,message,noticeType}=payload,newNotice={code,message,noticeType},newNotices=state.notices.filter((notice=>notice.code!==code));return newNotices.push(newNotice),{...state,notices:newNotices}}default:return state}},resolvers:{},selectors:{getNotices:state=>state.notices,getNotice:(state,code)=>state.notices.find((notice=>notice.code===code))}}),notices=(notices_store.initialState,notices_store.actions,notices_store.controls,notices_store.reducer,notices_store.resolvers,notices_store.selectors,notices_store);var constants=__webpack_require__("./assets/js/datastores/constants.js");const datastores_store=combineStores(notices,users),validContexts=((0,redux_store.A)(constants.E,datastores_store),["default","delete","edit","create"]),context_baseActions={setContext:context=>({type:"SET_CONTEXT",payload:{context}})},context_store=combineStores({initialState:{context:"default"},actions:context_baseActions,reducer:(state,{type,payload})=>{if("SET_CONTEXT"===type){const{context}=payload;return browser_default()(validContexts.includes(context),"Invalid context: %s",context),{...state,context}}return state},selectors:{getContext:state=>state.context}}),ui_context=(context_store.initialState,context_store.actions,context_store.controls,context_store.reducer,context_store.resolvers,context_store.selectors,context_store),delete_baseInitialState={userData:void 0},delete_store=combineStores({initialState:delete_baseInitialState,actions:{setUserForDeletion:userData=>({type:"SET_USER_FOR_DELETION",payload:{userData}}),resetDeleteConfirmation:()=>({type:"RESET_DELETE_CONFIRMATION"})},reducer:(state,{type,payload})=>{switch(type){case"SET_USER_FOR_DELETION":{const{userData}=payload;return{...state,userData}}case"RESET_DELETE_CONFIRMATION":return{...state,...delete_baseInitialState};default:return state}},selectors:{getUserToDelete:state=>state.userData}}),ui_delete=(delete_store.initialState,delete_store.actions,delete_store.controls,delete_store.reducer,delete_store.resolvers,delete_store.selectors,delete_store),edit_baseInitialState={step:0,user:null,errors:[],data:{},stepValidationFn:()=>!0},edit_store=combineStores({initialState:edit_baseInitialState,actions:{setStep:step=>({type:"SET_STEP",payload:{step}}),setStepValidationFn:validationFn=>({type:"SET_STEP_VALIDATION_FN",payload:{validationFn}}),incrementStep:()=>({type:"INCREMENT_STEP"}),decrementStep:()=>({type:"DECREMENT_STEP"}),resetStep:()=>({type:"RESET_STEP"}),setUser:user=>({type:"SET_USER",payload:{user}}),setError:(code,message)=>({type:"SET_ERROR",payload:{code,message}}),clearError:code=>({type:"CLEAR_ERROR",payload:{code}}),clearErrors:()=>({type:"CLEAR_ERRORS"}),setData:(property,data)=>({type:"SET_DATA",payload:{property,data}}),resetForm:()=>({type:"RESET_FORM"})},reducer:(state,{type,payload})=>{switch(type){case"SET_STEP":{const{step}=payload;return{...state,step}}case"SET_STEP_VALIDATION_FN":{const{validationFn}=payload;return{...state,stepValidationFn:validationFn}}case"INCREMENT_STEP":return{...state,step:state.step+1};case"DECREMENT_STEP":return{...state,step:state.step-1};case"RESET_STEP":return{...state,step:1};case"SET_USER":{const{user}=payload,{first_name,last_name,user_email,role,start_date,end_date,ID,start_date_local,end_date_local}=user||{},data={name:first_name,surname:last_name,email:user_email,role,startDate:start_date,endDate:end_date,ID,startDateLocal:start_date_local,endDateLocal:end_date_local};return{...state,data,user:user||null}}case"SET_ERROR":{const{code,message}=payload,errors=state.errors.filter((error=>error.code!==code));return{...state,errors:[...errors,{code,message}]}}case"CLEAR_ERROR":{const{code}=payload,errors=state.errors.filter((error=>error.code!==code));return{...state,errors}}case"CLEAR_ERRORS":return{...state,errors:[]};case"SET_DATA":{const{property,data}=payload;return{...state,data:{...state.data,[property]:data}}}case"RESET_FORM":return{...state,...edit_baseInitialState};default:return state}},selectors:{getCurrentStep:state=>state.step,getUser:state=>state.user,isUserEdit:state=>!!state.user,getErrors:state=>state.errors,getData:(state,field)=>field?state.data[field]:state.data,getState:state=>state,getStepValidationFn:state=>state.stepValidationFn}}),edit=(edit_store.initialState,edit_store.actions,edit_store.controls,edit_store.reducer,edit_store.resolvers,edit_store.selectors,edit_store),list_store=combineStores({initialState:{pageModal:{page:0,pageSize:5}},actions:{setPageModal:pageModal=>({type:"SET_PAGE_MODAL",payload:{pageModal}})},reducer:(state,{type,payload})=>{if("SET_PAGE_MODAL"===type){const{pageModal}=payload;return{...state,pageModal}}return state},selectors:{getPageModal:state=>state.pageModal}}),ui_store=(list_store.initialState,list_store.actions,list_store.controls,list_store.reducer,list_store.resolvers,combineStores(ui_context,edit,ui_delete,list_store)),createTestRegistry=((0,redux_store.A)(constants.r,ui_store),()=>{const storeConfig={[constants.E]:datastores_store,[constants.r]:ui_store};return(0,build_module_registry.I)(storeConfig)});function WithTestRegistry({children,registry=createTestRegistry()}={}){return(0,jsx_runtime.jsx)(context.Ay,{value:registry,children})}WithTestRegistry.__docgenInfo={description:"",methods:[],displayName:"WithTestRegistry"}}}]);